"use strict";(self.webpackChunkmy_project=self.webpackChunkmy_project||[]).push([[4642],{74642:(ts,c,s)=>{s.r(c),s.d(c,{CreatePage:()=>v,default:()=>z});var t=s(53657),m=s(96125),I=s(7139),B=s(55613),l=s(93134),g=s(99283),T=s(6620),d=s(2669),h=s(60590),f=s(50810),R=s(91845),U=s(34773),W=s(84139),i=s(29370),K=s(14752),u=s(37944),x=s(18239),j=s(85392),p=s(82154),y=s(2108),C=s(33541),S=s(87426),$=s(4771),E=s(44402),M=s(59891),es=s(80107),as=s(36336),is=s(70662),ns=s(43628),os=s(33099),ds=s(25291),_s=s(70464),ls=s(1108),rs=s(83937),Es=s(3404),Ms=s(18514),Ps=s(92898),Ds=s(96435),Os=s(50973),cs=s(20590),ms=s(22507),gs=s(7453),hs=s(80922),Rs=s(12646),Cs=s(80655),vs=s(66437),Ls=s(6219),As=s(13236);const Z=M.Ry().shape({name:M.Z_().required(i.I0.required),description:M.Z_().required(i.I0.required)}),N=S.default.div`
  border: 1px solid ${({theme:e})=>e.colors.primary200};
  background: ${({theme:e})=>e.colors.primary100};
  padding: ${({theme:e})=>`${e.spaces[2]} ${e.spaces[4]}`};
  color: ${({theme:e})=>e.colors.primary600};
  border-radius: ${({theme:e})=>e.borderRadius};
  font-size: ${12/16}rem;
  font-weight: bold;
`,v=()=>{const e=(0,C.$B)("/settings/roles/duplicate/:id"),L=(0,i.lm)(),{lockApp:F,unlockApp:V}=(0,i.o1)(),{formatMessage:a}=(0,p.Z)(),[J,P]=(0,m.useState)(!1),{replace:Y}=(0,C.k6)(),D=(0,m.useRef)(),{trackUsage:r}=(0,i.rS)(),{post:G,put:H}=(0,i.kY)(),{params:_}=e??{},{isLoading:Q,data:X}=(0,E.u)(_?.id,{cacheTime:0}),{permissions:b,isLoading:k}=(0,E.a)({id:_?.id},{cacheTime:0,enabled:!!_?.id}),w=O=>{F(),P(!0),_?.id?r("willDuplicateRole"):r("willCreateNewRole"),Promise.resolve(G("/admin/roles",O)).then(async({data:n})=>{const{permissionsToSend:o}=D.current.getPermissions();return _?.id?r("didDuplicateRole"):r("didCreateNewRole"),n.data.id&&!j(o)&&await H(`/admin/roles/${n.data.id}/permissions`,{permissions:o}),n}).then(n=>{P(!1),L({type:"success",message:{id:"Settings.roles.created",defaultMessage:"created"}}),Y(`/settings/roles/${n.data.id}`)}).catch(n=>{console.error(n),P(!1),L({type:"warning",message:{id:"notification.error"}})}).finally(()=>{V()})},q=`${a({id:"Settings.roles.form.created",defaultMessage:"Created"})} ${(0,u.Z)(new Date,"PPP")}`;return(0,t.jsxs)(I.o,{children:[(0,t.jsx)(i.SL,{name:"Roles"}),(0,t.jsx)(x.J9,{initialValues:{name:"",description:q},onSubmit:w,validationSchema:Z,validateOnChange:!1,children:({handleSubmit:O,values:n,errors:o,handleReset:ss,handleChange:A})=>(0,t.jsx)(i.l0,{noValidate:!0,children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(B.T,{primaryAction:(0,t.jsxs)(l.k,{gap:2,children:[(0,t.jsx)(g.z,{variant:"secondary",onClick:()=>{ss(),D.current.resetForm()},size:"L",children:a({id:"app.components.Button.reset",defaultMessage:"Reset"})}),(0,t.jsx)(g.z,{onClick:O,loading:J,size:"L",children:a({id:"global.save",defaultMessage:"Save"})})]}),title:a({id:"Settings.roles.create.title",defaultMessage:"Create a role"}),subtitle:a({id:"Settings.roles.create.description",defaultMessage:"Define the rights given to the role"}),navigationAction:(0,t.jsx)(i.rU,{startIcon:(0,t.jsx)(K.Z,{}),to:"/settings/roles",children:a({id:"global.back",defaultMessage:"Back"})})}),(0,t.jsx)(T.D,{children:(0,t.jsxs)(l.k,{direction:"column",alignItems:"stretch",gap:6,children:[(0,t.jsx)(d.x,{background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0,children:(0,t.jsxs)(l.k,{direction:"column",alignItems:"stretch",gap:4,children:[(0,t.jsxs)(l.k,{justifyContent:"space-between",children:[(0,t.jsxs)(d.x,{children:[(0,t.jsx)(d.x,{children:(0,t.jsx)(h.Z,{fontWeight:"bold",children:a({id:"global.details",defaultMessage:"Details"})})}),(0,t.jsx)(d.x,{children:(0,t.jsx)(h.Z,{variant:"pi",textColor:"neutral600",children:a({id:"Settings.roles.form.description",defaultMessage:"Name and description of the role"})})})]}),(0,t.jsx)(N,{children:a({id:"Settings.roles.form.button.users-with-role",defaultMessage:"{number, plural, =0 {# users} one {# user} other {# users}} with this role"},{number:0})})]}),(0,t.jsxs)(f.r,{gap:4,children:[(0,t.jsx)(R.P,{col:6,children:(0,t.jsx)(U.o,{name:"name",error:o.name&&a({id:o.name}),label:a({id:"global.name",defaultMessage:"Name"}),onChange:A,required:!0,value:n.name})}),(0,t.jsx)(R.P,{col:6,children:(0,t.jsx)(W.g,{label:a({id:"global.description",defaultMessage:"Description"}),id:"description",error:o.description&&a({id:o.description}),onChange:A,children:n.description})})]})]})}),!Q&&!k?(0,t.jsx)(d.x,{shadow:"filterShadow",hasRadius:!0,children:(0,t.jsx)(E.P,{isFormDisabled:!1,ref:D,permissions:b,layout:X})}):(0,t.jsx)(d.x,{background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0,children:(0,t.jsx)(i.dO,{})})]})})]})})})]})};function z(){const e=(0,y.v9)($.s);return(0,t.jsx)(i.O4,{permissions:e.settings.roles.create,children:(0,t.jsx)(v,{})})}}}]);
