"use strict";(self.webpackChunkmy_project=self.webpackChunkmy_project||[]).push([[3032],{53032:(S,f,s)=>{s.r(f),s.d(f,{default:()=>V});var e=s(53657),g=s(96125),c=s(70139),u=s(6620),m=s(2669),x=s(7139),d=s(55613),p=s(87710),T=s(15227),h=s(41427),E=s(35960),l=s(48814),j=s(18946),P=s(93134),M=s(9991),A=s(46667),r=s(29776),D=s(65250),O=s(13172),L=s(63922),B=s(3404),I=s(82154),a=s(87426),_=s(87434),o=s(3972),q=s(80107);const V=()=>{(0,r.useFocusWhenNavigate)();const{formatMessage:n}=(0,I.Z)(),{data:i,isLoading:U,isError:N,remove:F,regenerate:H}=(0,o.u)(),[C,R]=(0,g.useState)(!1),[Q,W]=(0,g.useState)(!1),[G,z]=(0,g.useState)(),{allowedActions:v}=(0,r.useRBAC)(_.P),J=4,X=(i?.docVersions?.length||0)+1,Y=t=>{H.mutate({version:t,prefix:i?.prefix})},w=()=>{R(!C)},b=async()=>{W(!0),await F.mutateAsync({prefix:i?.prefix,version:G}),R(!C),W(!1)},k=t=>{z(t),R(!C)},$=n({id:(0,o.g)("plugin.name"),defaultMessage:"Documentation"});return N?(0,e.jsx)(c.A,{children:(0,e.jsx)(u.D,{children:(0,e.jsx)(m.x,{paddingTop:8,children:(0,e.jsx)(r.AnErrorOccurred,{})})})}):(0,e.jsxs)(c.A,{children:[(0,e.jsx)(B.q,{title:$}),(0,e.jsxs)(x.o,{"aria-busy":U,children:[(0,e.jsx)(d.T,{title:$,subtitle:n({id:(0,o.g)("pages.PluginPage.header.description"),defaultMessage:"Configure the documentation plugin"}),primaryAction:(0,e.jsx)(Z,{disabled:!v.canOpen||!i?.currentVersion||!i?.prefix,href:K(`${i?.prefix}/v${i?.currentVersion}`),startIcon:(0,e.jsx)(D.Z,{}),children:n({id:(0,o.g)("pages.PluginPage.Button.open"),defaultMessage:"Open Documentation"})})}),(0,e.jsxs)(u.D,{children:[U&&(0,e.jsx)(r.LoadingIndicatorPage,{children:"Plugin is loading"}),i?.docVersions.length?(0,e.jsxs)(p.i,{colCount:J,rowCount:X,children:[(0,e.jsx)(T.h,{children:(0,e.jsxs)(h.Tr,{children:[(0,e.jsx)(E.Th,{children:(0,e.jsx)(l.Z,{variant:"sigma",textColor:"neutral600",children:n({id:(0,o.g)("pages.PluginPage.table.version"),defaultMessage:"Version"})})}),(0,e.jsx)(E.Th,{children:(0,e.jsx)(l.Z,{variant:"sigma",textColor:"neutral600",children:n({id:(0,o.g)("pages.PluginPage.table.generated"),defaultMessage:"Last Generated"})})})]})}),(0,e.jsx)(j.p,{children:i.docVersions.sort((t,y)=>t.generatedDate<y.generatedDate?1:-1).map(t=>(0,e.jsxs)(h.Tr,{children:[(0,e.jsx)(E.Td,{width:"50%",children:(0,e.jsx)(l.Z,{children:t.version})}),(0,e.jsx)(E.Td,{width:"50%",children:(0,e.jsx)(l.Z,{children:t.generatedDate})}),(0,e.jsx)(E.Td,{children:(0,e.jsxs)(P.k,{justifyContent:"end",onClick:y=>y.stopPropagation(),children:[(0,e.jsx)(M.h,{forwardedAs:"a",disabled:!v.canOpen,href:K(`${i.prefix}/v${t.version}`),noBorder:!0,icon:(0,e.jsx)(D.Z,{}),target:"_blank",rel:"noopener noreferrer",label:n({id:(0,o.g)("pages.PluginPage.table.icon.show"),defaultMessage:"Open {target}"},{target:`${t.version}`})}),v.canRegenerate?(0,e.jsx)(M.h,{onClick:()=>Y(t.version),noBorder:!0,icon:(0,e.jsx)(O.Z,{}),label:n({id:(0,o.g)("pages.PluginPage.table.icon.regenerate"),defaultMessage:"Regenerate {target}"},{target:`${t.version}`})}):null,v.canUpdate&&t.version!==i.currentVersion?(0,e.jsx)(M.h,{onClick:()=>k(t.version),noBorder:!0,icon:(0,e.jsx)(L.Z,{}),label:n({id:"global.delete-target",defaultMessage:"Delete {target}"},{target:`${t.version}`})}):null]})})]},t.version))})]}):(0,e.jsx)(r.EmptyStateLayout,{})]}),(0,e.jsx)(r.ConfirmDialog,{isConfirmButtonLoading:Q,onConfirm:b,onToggleDialog:w,isOpen:C})]})]})},Z=(0,a.default)(A.Q)`
  text-decoration: none;
`,K=n=>n.startsWith("http")?n:n.startsWith("/")?`${window.strapi.backendURL}${n}`:`${window.strapi.backendURL}/${n}`},3972:(S,f,s)=>{s.d(f,{g:()=>m,u:()=>x});var e=s(96125),g=s(29776),c=s(80107),u=s(87434);const m=d=>`${u.p}.${d}`,x=()=>{const d=(0,g.useNotification)(),{del:p,post:T,put:h,get:E}=(0,g.useFetchClient)(),{formatAPIError:l}=(0,g.useAPIErrorHandler)(),{isLoading:j,isError:P,data:M,refetch:A,error:r}=(0,c.useQuery)(["get-documentation",u.p],async()=>{const{data:a}=await E(`/${u.p}/getInfos`);return a});(0,e.useEffect)(()=>{P&&r&&d({type:"warning",message:r?l(r):{id:"notification.error"}})},[P,r,d,l]);const D=a=>{d({type:"warning",message:l(a)})},O=(a,_,o)=>{A(),d({type:a,message:{id:m(_),defaultMessage:o}})},L=(0,c.useMutation)(({prefix:a,version:_})=>p(`${a}/deleteDoc/${_}`),{onSuccess:()=>O("info","notification.delete.success","Successfully deleted documentation"),onError:D}),B=(0,c.useMutation)(({prefix:a,body:_})=>h(`${a}/updateSettings`,_),{onSuccess:()=>O("success","notification.update.success","Successfully updated settings"),onError:D}),I=(0,c.useMutation)(({prefix:a,version:_})=>T(`${a}/regenerateDoc`,{version:_}),{onSuccess:()=>O("info","notification.generate.success","Successfully generated documentation"),onError:D});return{data:M,isLoading:j,isError:P,remove:L,submit:B,regenerate:I}}}}]);
